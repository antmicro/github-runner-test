on: [push]

name: test

jobs:
  centos:
    container: ubuntu:bionic 
    runs-on: [self-hosted, Linux, X64]
    env:
      GHA_EXTERNAL_DISK: "auxdisk"
      GHA_PREEMPTIBLE: "false"
      GHA_SSH_TUNNEL_KEY: "${{ secrets.GHA_SSH_TUNNEL_KEY_GARBAGE }}"
      GHA_SSH_TUNNEL_CONFIG: "${{ secrets.GHA_SSH_TUNNEL_CONFIG }}"
      GHA_SSH_TUNNEL_CONFIG_SECRET_NAME: "nginx_server_config"
      GHA_SSH_TUNNEL_KEY_SECRET_NAME: "nginx_server_key"
      
    steps:
    - name: 'üõ†Ô∏è Setup Python and gsutil'
      run: |
        apt update -qqy
        apt install -qqy curl python3
        echo "deb [signed-by=/usr/share/keyrings/cloud.google.gpg] https://packages.cloud.google.com/apt cloud-sdk main" | tee -a /etc/apt/sources.list.d/google-cloud-sdk.list
        curl https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key --keyring /usr/share/keyrings/cloud.google.gpg add -
        apt update -qqy
        apt install -qqy google-cloud-cli
