on: [push]

name: test

jobs:
  simple-job:
    container: debian:bullseye
    runs-on: [self-hosted, Linux, X64]
    env:
      GHA_PREEMPTIBLE: "false"
      ART: "art.txt"
    steps:
    - uses: actions/checkout@v2
      with:
          submodules: recursive
    - run: ls -alh | tee -a $ART
    - run: hostname | tee -a $ART
    - run: printenv | tee -a $ART
    - run: df -h . | tee -a $ART
    - name: upload artifact
      uses: actions/upload-artifact@v3
      with:
        path: ${{ env.ART }}

  ipv6-test:
    container: debian:bullseye
    runs-on: [self-hosted, Linux, X64]
    env:
      GHA_PREEMPTIBLE: "false"
      ART: "art.txt"
    steps:
    - run: apt -qqy update && apt -qqy install iputils-ping iproute2 | tee -a $ART
    - run: ip a | tee -a $ART
    - run: ping -c 3 ipv6.google.com | tee -a $ART
    - name: upload artifact
      uses: actions/upload-artifact@v3
      with:
        path: ${{ env.ART }}
